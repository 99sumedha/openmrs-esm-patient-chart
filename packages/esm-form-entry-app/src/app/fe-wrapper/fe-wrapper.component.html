<div *ngIf="!formSubmitted" [ngClass]="{'error': hasValidationErrors}">
  <div class="content" (click)="onErrorPanelLostFocus()">
    <div *ngIf="!isLoading && !hasError" class="form-container">
      <div>
        <h6 *ngIf="singleSpaProps.encounterUuid" class="encounterHeader">Encounter date time {{encounterDate}} @
          {{encounterTime}}</h6>
        <form class="bx--form no-padding" *ngIf="formSchema" [formGroup]="form.rootNode.control">
          <form-renderer [node]="form.rootNode"></form-renderer>
        </form>
      </div>
      <div class="bx-btn--set button-set">
        <button class="bx--btn bx--btn--secondary" (click)="closeForm()" type="button">Discard</button>
        <button class="bx--btn bx--btn--primary" (click)="onSubmit($event)" type="submit">Save and close</button>
      </div>
    </div>
    <div *ngIf="hasError" class="omrs-app-error error-container">
      <h1>Form loading error</h1>
      <p>Something went wrong. Please try reloading.</p>
      <p>If the problem persists contact your system administrator.</p>
      <button class="bx--btn bx--btn--secondary" (click)="closeForm()" type="button">Close</button>
      <div class="bx--snippet bx--snippet--multi">
        <div class="bx--snippet-container" aria-label="code-snippet" style="max-height: 240px; min-height: 48px;">
          <pre><code>{{loadingError}}</code></pre>
        </div>
        <div class="bx--snippet__overflow-indicator--right"></div><button type="button" class="bx--copy-btn bx--copy"
          title="Copy to clipboard" aria-live="polite"><svg focusable="false" preserveAspectRatio="xMidYMid meet"
            xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="16" height="16" viewBox="0 0 32 32"
            aria-hidden="true" class="bx--snippet__icon">
            <path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z">
            </path>
            <path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z"></path>
          </svg>Copy to clipboard<span aria-hidden="true" class="bx--assistive-text bx--copy-btn__feedback">Copied to
            clipboard</span></button><button tabindex="0"
          class="bx--snippet-btn--expand bx--btn bx--btn--md bx--btn--ghost" type="button"><span
            class="bx--snippet-btn--text">Show more</span><svg focusable="false" preserveAspectRatio="xMidYMid meet"
            xmlns="http://www.w3.org/2000/svg" fill="currentColor" aria-label="Show more" name="chevron--down"
            role="img" width="16" height="16" viewBox="0 0 16 16" class="bx--icon-chevron--down bx--snippet__icon">
            <path d="M8 11L3 6 3.7 5.3 8 9.6 12.3 5.3 13 6z"></path>
          </svg></button>
      </div>
    </div>
  </div>
</div>

<div *ngIf="isLoading" class="loader-container">
  <div class="bx--inline-loading" aria-live="assertive" class="loader">
    <div class="bx--inline-loading__animation">
      <div aria-atomic="true" aria-labelledby="loading-id-2" aria-live="assertive"
        class="bx--loading bx--loading--small">
        <label id="loading-id-2" class="bx--visually-hidden">Active loading indicator</label>
        <svg class="bx--loading__svg" viewBox="0 0 100 100">
          <title>Active loading indicator</title>
          <circle class="bx--loading__background" cx="50%" cy="50%" r="44"></circle>
          <circle class="bx--loading__stroke" cx="50%" cy="50%" r="44"></circle>
        </svg>
      </div>
    </div>
    <div class="bx--inline-loading__text">Loading...</div>
  </div>
</div>